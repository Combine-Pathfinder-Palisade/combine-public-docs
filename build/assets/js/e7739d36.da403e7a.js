"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9293],{8299:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>m,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"Combine AWS/deploying-maintaining/other-commands","title":"Other Commands","description":"last updated: 1/6/2025","source":"@site/docs/Combine AWS/deploying-maintaining/other-commands.md","sourceDirName":"Combine AWS/deploying-maintaining","slug":"/Combine AWS/deploying-maintaining/other-commands","permalink":"/Combine AWS/deploying-maintaining/other-commands","draft":false,"unlisted":false,"editUrl":"https://github.com/Combine-Pathfinder-Palisade/combine-docs/blob/main/docs/Combine AWS/deploying-maintaining/other-commands.md","tags":[],"version":"current","lastUpdatedBy":"github-actions","lastUpdatedAt":1739223322000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Minor Upgrade","permalink":"/Combine AWS/deploying-maintaining/minor-upgrade"},"next":{"title":"Support Duties","permalink":"/Combine AWS/deploying-maintaining/support-duties"}}');var s=t(4848),a=t(8453);const o={},r="Other Commands",c={},d=[{value:"List all Commands - <code>CombineCommandList</code>",id:"list-all-commands---combinecommandlist",level:2},{value:"Rebuild TAP Certificates - <code>certificates_rebuild_tap</code>",id:"rebuild-tap-certificates---certificates_rebuild_tap",level:2}];function l(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"other-commands",children:"Other Commands"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"last updated: 1/6/2025"})}),"\n",(0,s.jsxs)(n.h2,{id:"list-all-commands---combinecommandlist",children:["List all Commands - ",(0,s.jsx)(n.code,{children:"CombineCommandList"})]}),"\n",(0,s.jsx)(n.p,{children:"The Combine automation tool can display all existing commands; you can run it like this:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["On Mac/Linux: ",(0,s.jsx)(n.code,{children:'java -classpath "combine-account-automation/lib/*:combine-account-automation/target/*" com.sequoia.combine.accounts.CombineCommandList'})]}),"\n",(0,s.jsxs)(n.li,{children:["On Windows: ",(0,s.jsx)(n.code,{children:"java -classpath combine-account-automation/lib/*;combine-account-automation/target/* com.sequoia.combine.accounts.CombineCommandList"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The output will look something like:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Command                                   Description                                                           \ncreate_admin_user                         Creates Admin user in TAP, will fail if there is no user management account.\ndestroy                                   TBD                                                                   \ncreate_greybox_user                       TBD                                                                   \nbuild_certificate_authority               Builds CA and stores in Amazon Certificates Manager.                  \nfull_no_vpc                               TBD                                                                   \nssh_key_repair                            TBD                                                                   \nstage                                     TBD                                                                   \nfull                                      TBD                                                                   \ncertificates_repair                       TBD                                                                   \ncertificates_rebuild_tap                  TBD                                                                   \ncertificates_rebuild_endpoints            TBD                                                                   \ncertificates_rebuild_tap_custom_dns       TBD                                                                   \nupdate                                    Updates the customer's devops bucket, does NOT do instance refresh    \nbuild_greybox                             TBD                                                                   \nmigrate_to_3_dot_x                        Generic Upgrade, not including follower accounts and shards.          \nmigrate_to_3_dot_12                       Upgrade to 3.12.X; todos are to parameterize the stack names.         \nmigrate_to_3_dot_13                       Upgrade to 3.13. Does NOT do instance refresh.  \n"})}),"\n",(0,s.jsxs)(n.h2,{id:"rebuild-tap-certificates---certificates_rebuild_tap",children:["Rebuild TAP Certificates - ",(0,s.jsx)(n.code,{children:"certificates_rebuild_tap"})]}),"\n",(0,s.jsxs)(n.p,{children:["Both TAP certificates, ",(0,s.jsx)(n.code,{children:"internal"})," and ",(0,s.jsx)(n.code,{children:"external"})," (which are for accessing TAP external and internal to the Combine VPC) will expire at some point. Usually this is every two years."]}),"\n",(0,s.jsx)(n.p,{children:"For example:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:t(8052).A+"",width:"685",height:"592"})}),"\n",(0,s.jsxs)(n.p,{children:["The cert date is invalid, as you can see from the error (",(0,s.jsx)(n.code,{children:"ERR_CERT_DATE_INVALID"}),"). If we examine the cert we'll confirm this:"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.img,{src:t(6365).A+"",width:"530",height:"609"}),"\n(today's date is 1/6/2025)"]}),"\n",(0,s.jsx)(n.p,{children:"If the certs expire, users will be presented with a warning in the browser that the certificate served from the TAP server is unsafe due to the expiration."}),"\n",(0,s.jsxs)(n.p,{children:["To do this, run the ",(0,s.jsx)(n.code,{children:"certificates_rebuild_tap"})," command, remembering to build the automation tool jar, as with all other Automation Tool Commands."]}),"\n",(0,s.jsxs)(n.p,{children:["A sample invocation: ",(0,s.jsx)(n.code,{children:'mvn exec:java -q "-Dexec.args=certificates_rebuild_tap --config-store-profile customerNameFromClientsDotJson --bricks-release-version bricks_v_3_12_3"'})]}),"\n",(0,s.jsx)(n.p,{children:"The command will spit out some logs, ending with this one:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"TAP Certificates Updated in S3.\n"})}),"\n",(0,s.jsxs)(n.p,{children:["You can confirm this by navigating to the ",(0,s.jsx)(n.code,{children:"combine-devops"})," bucket in the customer's account and checking the tap cert updated dates (certs live in the ",(0,s.jsx)(n.code,{children:"/certificates"})," directory):"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:t(591).A+"",width:"1170",height:"887"})}),"\n",(0,s.jsx)(n.p,{children:"The new certificates have overwritten the outdated ones."}),"\n",(0,s.jsxs)(n.p,{children:["From here, you need to perform an ",(0,s.jsx)(n.a,{href:"../developing/architecture#instance-refresh",children:"instance refresh"})," on the TAP autoscaling group, which will run the launch template on the new TAP instances and pull down the new certificates."]})]})}function m(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},591:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/cert-updated-dates-d0c6e8983a777174b757a3f6f91d86d5.png"},6365:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/expired-tap-cert-f489117cfd2a0e557beb60c46a62236f.png"},8052:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/warning-tap-cert-cc995ebdf36f54e2df0d6b410955042b.png"},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>r});var i=t(6540);const s={},a=i.createContext(s);function o(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);